<!DOCTYPE html>
<html>
<head>
    <title>SOC1 - Submit Answer</title>
</head>
<body>
    <h2>Submit your answer</h2>
    <form id="ctfForm">
        <label>Username:</label><br>
        <input type="text" id="username" value="player1" required><br><br>

        <label>Question ID:</label><br>
        <input type="text" id="question_id" value="soc1_q1" required><br><br>

        <label>Your Answer:</label><br>
        <input type="text" id="player_answer" required><br><br>

        <button type="submit">Submit</button>
    </form>

    <p id="result"></p>

    <script>
        document.getElementById("ctfForm").addEventListener("submit", async function(e){
            e.preventDefault();

            const payload = {
                username: document.getElementById("username").value,
                question_id: document.getElementById("question_id").value,
                player_answer: document.getElementById("player_answer").value
            };

            const apiKey = "QnJXcW9wb0JGTlFTdVRzMlhEMHk6U2daSUEzdGRSRVNNOTgyeWtOQVk1UQ==";

            const res = await fetch(
                "https://xdrview.dc.turkuamk.fi:9200/botsv1_ctf_answers/_doc?pipeline=ctf_answer_checker",
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": "ApiKey " + apiKey
                    },
                    body: JSON.stringify(payload)
                }
            );

            const data = await res.json();

            // CHECK K·∫æT QU·∫¢
            if (data._source && data._source.is_correct === true) {
                document.getElementById("result").innerHTML =
                    "<span style='color: green; font-size: 22px;'>üéâ Correct!</span>";
            } else {
                document.getElementById("result").innerHTML =
                    "<span style='color: red; font-size: 22px;'>‚ùå Wrong! Try again.</span>";
            }
        });
    </script>
</body>
</html>
